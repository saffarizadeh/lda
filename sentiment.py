import pandas as pd
import numpy as np
import pickle

df = pd.read_excel('UnstructuredData.xlsx')

documents = []
for document in df.qual.tolist():
    try:
        document = document.strip()
    except:
        pass
    if type(document) == type('') and document != '' and document is not np.nan:
        documents.append(document)
    else:
        documents.append('OOOOOTTTTTT')


# Local Sentiment Analysis

# from transformers import pipeline
# sentiment_pipeline = pipeline("sentiment-analysis")
# print(sentiment_pipeline(documents))
# results = [{'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9990424513816833}, {'label': 'NEGATIVE', 'score': 0.9971092343330383}, {'label': 'NEGATIVE', 'score': 0.9996541738510132}, {'label': 'NEGATIVE', 'score': 0.9995501637458801}, {'label': 'POSITIVE', 'score': 0.99114590883255}, {'label': 'NEGATIVE', 'score': 0.9980858564376831}, {'label': 'POSITIVE', 'score': 0.6597164869308472}, {'label': 'NEGATIVE', 'score': 0.9996238946914673}, {'label': 'NEGATIVE', 'score': 0.9946681261062622}, {'label': 'NEGATIVE', 'score': 0.9743869304656982}, {'label': 'POSITIVE', 'score': 0.9809586405754089}, {'label': 'NEGATIVE', 'score': 0.9995321035385132}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.998308539390564}, {'label': 'NEGATIVE', 'score': 0.9563778042793274}, {'label': 'NEGATIVE', 'score': 0.9994643330574036}, {'label': 'NEGATIVE', 'score': 0.9996500015258789}, {'label': 'NEGATIVE', 'score': 0.9991220831871033}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'POSITIVE', 'score': 0.999578058719635}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.8298971056938171}, {'label': 'NEGATIVE', 'score': 0.9896458983421326}, {'label': 'NEGATIVE', 'score': 0.999647855758667}, {'label': 'POSITIVE', 'score': 0.9759352803230286}, {'label': 'NEGATIVE', 'score': 0.9934806823730469}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9976867437362671}, {'label': 'NEGATIVE', 'score': 0.9444952011108398}, {'label': 'NEGATIVE', 'score': 0.9931061863899231}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9990350008010864}, {'label': 'POSITIVE', 'score': 0.9994475245475769}, {'label': 'NEGATIVE', 'score': 0.999648928642273}, {'label': 'NEGATIVE', 'score': 0.9996080994606018}, {'label': 'NEGATIVE', 'score': 0.9904256463050842}, {'label': 'POSITIVE', 'score': 0.7776075005531311}, {'label': 'NEGATIVE', 'score': 0.9958125948905945}, {'label': 'POSITIVE', 'score': 0.8049995303153992}, {'label': 'POSITIVE', 'score': 0.9989399313926697}, {'label': 'POSITIVE', 'score': 0.9951228499412537}, {'label': 'NEGATIVE', 'score': 0.9630829095840454}, {'label': 'NEGATIVE', 'score': 0.9996758699417114}, {'label': 'POSITIVE', 'score': 0.9464253783226013}, {'label': 'NEGATIVE', 'score': 0.9988080263137817}, {'label': 'NEGATIVE', 'score': 0.9991125464439392}, {'label': 'NEGATIVE', 'score': 0.9698180556297302}, {'label': 'NEGATIVE', 'score': 0.99588543176651}, {'label': 'NEGATIVE', 'score': 0.999334990978241}, {'label': 'NEGATIVE', 'score': 0.9948770403862}, {'label': 'NEGATIVE', 'score': 0.9764286875724792}, {'label': 'POSITIVE', 'score': 0.6460976600646973}, {'label': 'POSITIVE', 'score': 0.999815046787262}, {'label': 'NEGATIVE', 'score': 0.8543646931648254}, {'label': 'NEGATIVE', 'score': 0.9850735068321228}, {'label': 'NEGATIVE', 'score': 0.9936848282814026}, {'label': 'NEGATIVE', 'score': 0.9938680529594421}, {'label': 'NEGATIVE', 'score': 0.9986541271209717}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'POSITIVE', 'score': 0.9998408555984497}, {'label': 'NEGATIVE', 'score': 0.9993829727172852}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9994645714759827}, {'label': 'POSITIVE', 'score': 0.9951299428939819}, {'label': 'POSITIVE', 'score': 0.9974883794784546}, {'label': 'POSITIVE', 'score': 0.99944669008255}, {'label': 'NEGATIVE', 'score': 0.9941937327384949}, {'label': 'NEGATIVE', 'score': 0.9991507530212402}, {'label': 'NEGATIVE', 'score': 0.997431218624115}, {'label': 'POSITIVE', 'score': 0.9990178346633911}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'POSITIVE', 'score': 0.9986358284950256}, {'label': 'NEGATIVE', 'score': 0.9997615218162537}, {'label': 'NEGATIVE', 'score': 0.9954259991645813}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9996750354766846}, {'label': 'NEGATIVE', 'score': 0.9896628260612488}, {'label': 'NEGATIVE', 'score': 0.9992709755897522}, {'label': 'POSITIVE', 'score': 0.999729335308075}, {'label': 'NEGATIVE', 'score': 0.9947070479393005}, {'label': 'NEGATIVE', 'score': 0.9996115565299988}, {'label': 'NEGATIVE', 'score': 0.9931378960609436}, {'label': 'NEGATIVE', 'score': 0.9965219497680664}, {'label': 'NEGATIVE', 'score': 0.9996802806854248}, {'label': 'NEGATIVE', 'score': 0.8244709968566895}, {'label': 'NEGATIVE', 'score': 0.9989293217658997}, {'label': 'NEGATIVE', 'score': 0.9921243786811829}, {'label': 'POSITIVE', 'score': 0.9979782700538635}, {'label': 'NEGATIVE', 'score': 0.9995406866073608}, {'label': 'NEGATIVE', 'score': 0.9969779253005981}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9529706239700317}, {'label': 'NEGATIVE', 'score': 0.998400866985321}, {'label': 'POSITIVE', 'score': 0.994350254535675}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'POSITIVE', 'score': 0.9997184872627258}, {'label': 'NEGATIVE', 'score': 0.9690203070640564}, {'label': 'NEGATIVE', 'score': 0.9996656179428101}, {'label': 'NEGATIVE', 'score': 0.9994779229164124}, {'label': 'NEGATIVE', 'score': 0.9992669224739075}, {'label': 'NEGATIVE', 'score': 0.9984018206596375}, {'label': 'NEGATIVE', 'score': 0.9927974343299866}, {'label': 'NEGATIVE', 'score': 0.9992333650588989}, {'label': 'POSITIVE', 'score': 0.9990121126174927}, {'label': 'NEGATIVE', 'score': 0.9875325560569763}, {'label': 'NEGATIVE', 'score': 0.9706676602363586}, {'label': 'NEGATIVE', 'score': 0.9979464411735535}, {'label': 'NEGATIVE', 'score': 0.9926317930221558}, {'label': 'NEGATIVE', 'score': 0.9998114705085754}, {'label': 'NEGATIVE', 'score': 0.822532057762146}, {'label': 'NEGATIVE', 'score': 0.9990140199661255}, {'label': 'POSITIVE', 'score': 0.9991124272346497}, {'label': 'NEGATIVE', 'score': 0.9968124032020569}, {'label': 'POSITIVE', 'score': 0.9979099631309509}, {'label': 'NEGATIVE', 'score': 0.999555766582489}, {'label': 'NEGATIVE', 'score': 0.9975019097328186}, {'label': 'NEGATIVE', 'score': 0.9996925592422485}, {'label': 'NEGATIVE', 'score': 0.9997954964637756}, {'label': 'POSITIVE', 'score': 0.9795739650726318}, {'label': 'POSITIVE', 'score': 0.9984643459320068}, {'label': 'NEGATIVE', 'score': 0.9994408488273621}, {'label': 'NEGATIVE', 'score': 0.9979475140571594}, {'label': 'NEGATIVE', 'score': 0.99085932970047}, {'label': 'NEGATIVE', 'score': 0.9108946919441223}, {'label': 'NEGATIVE', 'score': 0.8944479823112488}, {'label': 'NEGATIVE', 'score': 0.9997727274894714}, {'label': 'NEGATIVE', 'score': 0.9997257590293884}, {'label': 'NEGATIVE', 'score': 0.9188608527183533}, {'label': 'NEGATIVE', 'score': 0.9994934797286987}, {'label': 'NEGATIVE', 'score': 0.9957365989685059}, {'label': 'NEGATIVE', 'score': 0.999038815498352}, {'label': 'NEGATIVE', 'score': 0.998612642288208}, {'label': 'NEGATIVE', 'score': 0.8525694608688354}, {'label': 'NEGATIVE', 'score': 0.9991569519042969}, {'label': 'NEGATIVE', 'score': 0.9985960125923157}, {'label': 'NEGATIVE', 'score': 0.9997078776359558}, {'label': 'NEGATIVE', 'score': 0.998454213142395}, {'label': 'NEGATIVE', 'score': 0.9962168335914612}, {'label': 'NEGATIVE', 'score': 0.9994290471076965}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9994565844535828}, {'label': 'NEGATIVE', 'score': 0.9863914251327515}, {'label': 'POSITIVE', 'score': 0.9997946619987488}, {'label': 'POSITIVE', 'score': 0.9414879679679871}, {'label': 'NEGATIVE', 'score': 0.9998133778572083}, {'label': 'NEGATIVE', 'score': 0.9987044334411621}, {'label': 'NEGATIVE', 'score': 0.9993728995323181}, {'label': 'NEGATIVE', 'score': 0.9987622499465942}, {'label': 'POSITIVE', 'score': 0.5723609328269958}, {'label': 'NEGATIVE', 'score': 0.9995181560516357}, {'label': 'NEGATIVE', 'score': 0.9998049139976501}, {'label': 'NEGATIVE', 'score': 0.9933367967605591}, {'label': 'NEGATIVE', 'score': 0.9993656277656555}, {'label': 'NEGATIVE', 'score': 0.9997145533561707}, {'label': 'POSITIVE', 'score': 0.7507705688476562}, {'label': 'NEGATIVE', 'score': 0.9874491691589355}, {'label': 'NEGATIVE', 'score': 0.9994392991065979}, {'label': 'NEGATIVE', 'score': 0.9847109913825989}, {'label': 'NEGATIVE', 'score': 0.9996236562728882}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9996870756149292}, {'label': 'NEGATIVE', 'score': 0.9991412162780762}, {'label': 'NEGATIVE', 'score': 0.9970818161964417}, {'label': 'NEGATIVE', 'score': 0.9996236562728882}, {'label': 'NEGATIVE', 'score': 0.9949710369110107}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9959059953689575}, {'label': 'NEGATIVE', 'score': 0.9981794357299805}, {'label': 'NEGATIVE', 'score': 0.9933034777641296}, {'label': 'NEGATIVE', 'score': 0.7542691826820374}, {'label': 'POSITIVE', 'score': 0.9962104558944702}, {'label': 'POSITIVE', 'score': 0.972088098526001}, {'label': 'POSITIVE', 'score': 0.835307240486145}, {'label': 'NEGATIVE', 'score': 0.9723214507102966}, {'label': 'POSITIVE', 'score': 0.9994377493858337}, {'label': 'POSITIVE', 'score': 0.9975751042366028}, {'label': 'NEGATIVE', 'score': 0.998671293258667}, {'label': 'POSITIVE', 'score': 0.9134270548820496}, {'label': 'NEGATIVE', 'score': 0.9997079968452454}, {'label': 'NEGATIVE', 'score': 0.999799907207489}, {'label': 'NEGATIVE', 'score': 0.99080491065979}, {'label': 'POSITIVE', 'score': 0.7816978693008423}, {'label': 'NEGATIVE', 'score': 0.9884606599807739}, {'label': 'NEGATIVE', 'score': 0.9439970850944519}, {'label': 'POSITIVE', 'score': 0.9993278980255127}, {'label': 'POSITIVE', 'score': 0.9925179481506348}, {'label': 'NEGATIVE', 'score': 0.997748076915741}, {'label': 'POSITIVE', 'score': 0.998715877532959}, {'label': 'NEGATIVE', 'score': 0.9993756413459778}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.8159897327423096}, {'label': 'NEGATIVE', 'score': 0.9991509914398193}, {'label': 'NEGATIVE', 'score': 0.9995964169502258}, {'label': 'NEGATIVE', 'score': 0.9990807771682739}, {'label': 'NEGATIVE', 'score': 0.998685896396637}, {'label': 'POSITIVE', 'score': 0.9996765851974487}, {'label': 'NEGATIVE', 'score': 0.9995679259300232}, {'label': 'NEGATIVE', 'score': 0.9997403025627136}, {'label': 'NEGATIVE', 'score': 0.9993554949760437}, {'label': 'NEGATIVE', 'score': 0.9989408850669861}, {'label': 'POSITIVE', 'score': 0.9770662188529968}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9996970891952515}, {'label': 'NEGATIVE', 'score': 0.9995608925819397}, {'label': 'NEGATIVE', 'score': 0.9956701993942261}, {'label': 'NEGATIVE', 'score': 0.9598333835601807}, {'label': 'NEGATIVE', 'score': 0.9990693926811218}, {'label': 'NEGATIVE', 'score': 0.8416603207588196}, {'label': 'POSITIVE', 'score': 0.9905669093132019}, {'label': 'POSITIVE', 'score': 0.9138365387916565}, {'label': 'POSITIVE', 'score': 0.9976422190666199}, {'label': 'NEGATIVE', 'score': 0.9992501139640808}, {'label': 'NEGATIVE', 'score': 0.9997140765190125}, {'label': 'POSITIVE', 'score': 0.9973885416984558}, {'label': 'NEGATIVE', 'score': 0.9979751706123352}, {'label': 'NEGATIVE', 'score': 0.7597156763076782}, {'label': 'NEGATIVE', 'score': 0.9970357418060303}, {'label': 'POSITIVE', 'score': 0.9696230888366699}, {'label': 'POSITIVE', 'score': 0.9763925075531006}, {'label': 'NEGATIVE', 'score': 0.9996775388717651}, {'label': 'NEGATIVE', 'score': 0.9994311928749084}, {'label': 'NEGATIVE', 'score': 0.9906909465789795}, {'label': 'POSITIVE', 'score': 0.9926942586898804}, {'label': 'NEGATIVE', 'score': 0.9964906573295593}, {'label': 'NEGATIVE', 'score': 0.9978119134902954}, {'label': 'NEGATIVE', 'score': 0.999785840511322}, {'label': 'NEGATIVE', 'score': 0.9976623058319092}, {'label': 'NEGATIVE', 'score': 0.9994762539863586}, {'label': 'NEGATIVE', 'score': 0.9967119693756104}, {'label': 'NEGATIVE', 'score': 0.9961293935775757}, {'label': 'NEGATIVE', 'score': 0.9985039234161377}, {'label': 'NEGATIVE', 'score': 0.9994716048240662}, {'label': 'NEGATIVE', 'score': 0.9983100891113281}, {'label': 'NEGATIVE', 'score': 0.9977433681488037}, {'label': 'NEGATIVE', 'score': 0.999631404876709}, {'label': 'NEGATIVE', 'score': 0.999675989151001}, {'label': 'NEGATIVE', 'score': 0.9994833469390869}, {'label': 'NEGATIVE', 'score': 0.9975462555885315}, {'label': 'NEGATIVE', 'score': 0.9996325969696045}, {'label': 'POSITIVE', 'score': 0.9981726408004761}, {'label': 'NEGATIVE', 'score': 0.9994595646858215}, {'label': 'POSITIVE', 'score': 0.9964292645454407}, {'label': 'NEGATIVE', 'score': 0.9950900077819824}, {'label': 'NEGATIVE', 'score': 0.9988823533058167}, {'label': 'NEGATIVE', 'score': 0.9971350431442261}, {'label': 'NEGATIVE', 'score': 0.9997069239616394}, {'label': 'NEGATIVE', 'score': 0.9956633448600769}, {'label': 'NEGATIVE', 'score': 0.9846446514129639}, {'label': 'POSITIVE', 'score': 0.9961473941802979}, {'label': 'NEGATIVE', 'score': 0.9709195494651794}, {'label': 'NEGATIVE', 'score': 0.9415906071662903}, {'label': 'POSITIVE', 'score': 0.9991023540496826}, {'label': 'POSITIVE', 'score': 0.9969947338104248}, {'label': 'POSITIVE', 'score': 0.9467923045158386}, {'label': 'POSITIVE', 'score': 0.9390377998352051}, {'label': 'NEGATIVE', 'score': 0.9964467883110046}, {'label': 'NEGATIVE', 'score': 0.999481737613678}, {'label': 'NEGATIVE', 'score': 0.998088538646698}, {'label': 'NEGATIVE', 'score': 0.9992024302482605}, {'label': 'NEGATIVE', 'score': 0.9969198703765869}, {'label': 'NEGATIVE', 'score': 0.9829460382461548}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9996178150177002}, {'label': 'NEGATIVE', 'score': 0.9870201349258423}, {'label': 'NEGATIVE', 'score': 0.9921097159385681}, {'label': 'POSITIVE', 'score': 0.9784123301506042}, {'label': 'NEGATIVE', 'score': 0.9990217685699463}, {'label': 'NEGATIVE', 'score': 0.999538779258728}, {'label': 'POSITIVE', 'score': 0.997021496295929}, {'label': 'NEGATIVE', 'score': 0.9919633865356445}, {'label': 'POSITIVE', 'score': 0.9991239905357361}, {'label': 'POSITIVE', 'score': 0.9981164932250977}, {'label': 'POSITIVE', 'score': 0.9324508905410767}, {'label': 'POSITIVE', 'score': 0.8447378873825073}, {'label': 'NEGATIVE', 'score': 0.9677888751029968}, {'label': 'NEGATIVE', 'score': 0.9990906715393066}, {'label': 'POSITIVE', 'score': 0.9986585378646851}, {'label': 'POSITIVE', 'score': 0.9991944432258606}, {'label': 'POSITIVE', 'score': 0.9859610795974731}, {'label': 'POSITIVE', 'score': 0.9696592092514038}, {'label': 'POSITIVE', 'score': 0.9717195630073547}, {'label': 'POSITIVE', 'score': 0.9925768971443176}, {'label': 'NEGATIVE', 'score': 0.8228304982185364}, {'label': 'POSITIVE', 'score': 0.999744713306427}, {'label': 'NEGATIVE', 'score': 0.9996546506881714}, {'label': 'NEGATIVE', 'score': 0.9977523684501648}, {'label': 'NEGATIVE', 'score': 0.9061050415039062}, {'label': 'POSITIVE', 'score': 0.7294957637786865}, {'label': 'NEGATIVE', 'score': 0.999809205532074}, {'label': 'NEGATIVE', 'score': 0.9973143935203552}, {'label': 'NEGATIVE', 'score': 0.9996267557144165}, {'label': 'NEGATIVE', 'score': 0.9995217323303223}, {'label': 'POSITIVE', 'score': 0.9974263310432434}, {'label': 'NEGATIVE', 'score': 0.999210000038147}, {'label': 'NEGATIVE', 'score': 0.924523651599884}, {'label': 'NEGATIVE', 'score': 0.9983232617378235}, {'label': 'NEGATIVE', 'score': 0.9977947473526001}, {'label': 'POSITIVE', 'score': 0.999803364276886}, {'label': 'NEGATIVE', 'score': 0.999546229839325}, {'label': 'NEGATIVE', 'score': 0.995394229888916}, {'label': 'NEGATIVE', 'score': 0.9962133765220642}, {'label': 'NEGATIVE', 'score': 0.9992409944534302}, {'label': 'NEGATIVE', 'score': 0.9987449645996094}, {'label': 'NEGATIVE', 'score': 0.9996379613876343}, {'label': 'NEGATIVE', 'score': 0.999015212059021}, {'label': 'NEGATIVE', 'score': 0.9987779259681702}, {'label': 'NEGATIVE', 'score': 0.999049961566925}, {'label': 'NEGATIVE', 'score': 0.6359657049179077}, {'label': 'POSITIVE', 'score': 0.9995583891868591}, {'label': 'POSITIVE', 'score': 0.9995929598808289}, {'label': 'POSITIVE', 'score': 0.9082742929458618}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9985979199409485}, {'label': 'NEGATIVE', 'score': 0.9913344979286194}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.8977265357971191}, {'label': 'NEGATIVE', 'score': 0.9881389737129211}, {'label': 'POSITIVE', 'score': 0.9755089282989502}, {'label': 'NEGATIVE', 'score': 0.9997870326042175}, {'label': 'NEGATIVE', 'score': 0.9970974922180176}, {'label': 'NEGATIVE', 'score': 0.9996999502182007}, {'label': 'NEGATIVE', 'score': 0.9551675319671631}, {'label': 'NEGATIVE', 'score': 0.9995051622390747}, {'label': 'NEGATIVE', 'score': 0.9997953772544861}, {'label': 'NEGATIVE', 'score': 0.9996272325515747}, {'label': 'NEGATIVE', 'score': 0.9996260404586792}, {'label': 'NEGATIVE', 'score': 0.9907655715942383}, {'label': 'POSITIVE', 'score': 0.9570211172103882}, {'label': 'NEGATIVE', 'score': 0.9990672469139099}, {'label': 'NEGATIVE', 'score': 0.9943873286247253}, {'label': 'NEGATIVE', 'score': 0.9995369911193848}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9984174966812134}, {'label': 'NEGATIVE', 'score': 0.9991210103034973}, {'label': 'POSITIVE', 'score': 0.9994014501571655}, {'label': 'NEGATIVE', 'score': 0.9865977764129639}, {'label': 'NEGATIVE', 'score': 0.999182403087616}, {'label': 'NEGATIVE', 'score': 0.9993436932563782}, {'label': 'NEGATIVE', 'score': 0.9972322583198547}, {'label': 'NEGATIVE', 'score': 0.9996411800384521}, {'label': 'NEGATIVE', 'score': 0.9991083741188049}, {'label': 'NEGATIVE', 'score': 0.9500828981399536}, {'label': 'NEGATIVE', 'score': 0.9936181306838989}, {'label': 'NEGATIVE', 'score': 0.9994531273841858}, {'label': 'NEGATIVE', 'score': 0.9994256496429443}, {'label': 'NEGATIVE', 'score': 0.9627082943916321}, {'label': 'NEGATIVE', 'score': 0.9911012053489685}, {'label': 'NEGATIVE', 'score': 0.9612482786178589}, {'label': 'POSITIVE', 'score': 0.9992895126342773}, {'label': 'POSITIVE', 'score': 0.9707315564155579}, {'label': 'NEGATIVE', 'score': 0.9961148500442505}, {'label': 'NEGATIVE', 'score': 0.9994112253189087}, {'label': 'NEGATIVE', 'score': 0.9996503591537476}, {'label': 'NEGATIVE', 'score': 0.9972284436225891}, {'label': 'NEGATIVE', 'score': 0.5609949231147766}, {'label': 'POSITIVE', 'score': 0.9990808963775635}, {'label': 'NEGATIVE', 'score': 0.9582085609436035}, {'label': 'POSITIVE', 'score': 0.9972339272499084}, {'label': 'POSITIVE', 'score': 0.9977891445159912}, {'label': 'NEGATIVE', 'score': 0.9995617270469666}, {'label': 'NEGATIVE', 'score': 0.9986251592636108}, {'label': 'NEGATIVE', 'score': 0.9937117099761963}, {'label': 'NEGATIVE', 'score': 0.9992954730987549}, {'label': 'POSITIVE', 'score': 0.9811702370643616}, {'label': 'NEGATIVE', 'score': 0.9985535740852356}, {'label': 'NEGATIVE', 'score': 0.9994089603424072}, {'label': 'NEGATIVE', 'score': 0.9991877675056458}, {'label': 'POSITIVE', 'score': 0.9979841709136963}, {'label': 'NEGATIVE', 'score': 0.9991195797920227}, {'label': 'NEGATIVE', 'score': 0.9998124241828918}, {'label': 'NEGATIVE', 'score': 0.9984937906265259}, {'label': 'NEGATIVE', 'score': 0.9992064833641052}, {'label': 'NEGATIVE', 'score': 0.9958080053329468}, {'label': 'NEGATIVE', 'score': 0.9988368153572083}, {'label': 'NEGATIVE', 'score': 0.9917252063751221}, {'label': 'NEGATIVE', 'score': 0.9997206330299377}, {'label': 'NEGATIVE', 'score': 0.9937111139297485}, {'label': 'NEGATIVE', 'score': 0.999698281288147}, {'label': 'NEGATIVE', 'score': 0.9996943473815918}, {'label': 'NEGATIVE', 'score': 0.9997708201408386}, {'label': 'NEGATIVE', 'score': 0.9421676993370056}, {'label': 'NEGATIVE', 'score': 0.9995997548103333}, {'label': 'NEGATIVE', 'score': 0.9994981288909912}, {'label': 'NEGATIVE', 'score': 0.9957444071769714}, {'label': 'NEGATIVE', 'score': 0.9997715353965759}, {'label': 'NEGATIVE', 'score': 0.9992831349372864}, {'label': 'NEGATIVE', 'score': 0.9985552430152893}, {'label': 'NEGATIVE', 'score': 0.9997642636299133}, {'label': 'NEGATIVE', 'score': 0.9991198182106018}, {'label': 'NEGATIVE', 'score': 0.8711057305335999}]



# Google Cloud Sentiment Analysis
from google.cloud import language_v1
import six


def sample_analyze_sentiment(content):
    client = language_v1.LanguageServiceClient()

    if isinstance(content, six.binary_type):
        content = content.decode("utf-8")

    type_ = language_v1.Document.Type.PLAIN_TEXT
    document = {"type_": type_, "content": content}

    response = client.analyze_sentiment(request={"document": document})
    return response.document_sentiment


sentiments = []
for document in documents:
    sentiments.append(sample_analyze_sentiment(document))

with open("sentiments.pickle", 'wb') as f:
    pickle.dump(sentiments, f, protocol=pickle.HIGHEST_PROTOCOL)

scores = []
magnitudes = []
for sentiment in sentiments:
    scores.append(sentiment.score)
    magnitudes.append(sentiment.magnitude)

df = pd.DataFrame({'score': scores, 'magnitude': magnitudes})
df.to_excel('sentiments.xlsx')
